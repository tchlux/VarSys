
    <!doctype html>
    <meta charset="utf-8">

    
    <!-- Include Distill -->
    <!-- <script src="https://distill.pub/template.v1.js"></script> -->
     <script src="https://tchlux.github.io/documents/distill.template.v1.no-banner.js"></script> 
    <!-- <script src="/Users/thomaslux/Git/txt_to_html/txt_to_html/resources/distill.template.v1.no-banner.js"></script> -->
    
    
    <!-- Include MathJax -->
     <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"> </script> 
    <!-- <script type="text/javascript" async src="/Users/thomaslux/Git/txt_to_html/txt_to_html/resources/MathJax-2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML,local/local"></script> -->
    
    

    <!-- Script for setting up the author block -->
    <script type="text/front-matter">
      title: Methods of Estimating Derivatives
      description: In the context of quintic spline interpolation
      authors:
       - Thomas Lux: https://people.cs.vt.edu/tchlux

      affiliations:
       - tchlux@vt.edu

    </script>

    <style type="text/css">


      dt-article p {
        text-align: justify;
      }


      dt-article ol, dt-article ul {
        padding-left: 50px;
      }

      dt-article ul {
        list-style: none;
      }

      dt-article h2 {
        border-bottom: 1px solid #aaa;
      }

      dt-article h3 {
        font-style: normal;
      }

      dt-article h4 {
        font-size: 12pt;
      }

      dt-article li {
        margin-bottom: 10px;
      }

      ul li:before {
        content: "–  ";
        margin-left: -1em
      }

      td {
        padding-left: 10px !important;
        padding-right: 10px !important;
        padding-top: 7px !important;
        padding-bottom: 7px !important;
        line-height: 1.3 !important;
      }

      p.caption {
        line-height: 1.3;
        font-family: sans-serif;
        font-size: 15px;
        text-align: center;
        color: #777;
        margin-top: -30px;
        padding-top: 0px;
        padding-left: 30px;
        padding-right: 30px;
      }

    span.header {
      display: block;
      height: 3vh;
      margin-top: -3vh;
      visibility: hidden;
    }

    span.caption {
      display: block;
      height: 65vh;
      margin-top: -65vh;
      visibility: hidden;
    }

    .jump {
      color: #333;
      border-bottom: 1px solid #eee;
    }

    .jump:hover {
      color: #888;
      border-bottom: 1px dotted #eee;
    }

    </style>

    <dt-article>
    <h1>Methods of Estimating Derivatives</h1>
    <p>In the context of quintic spline interpolation</p>
    <dt-byline></dt-byline>

    
<p>
The problem of piecewise monotone quintic spline interpolation is posed given points \(\big\{x_i\big\}_{i=1}^{n},\) \(x_i < x_{i+1}\) and associated function values \(\big\{f(x_i)\big\}_{i=1}^{n}\). The process of making a monotone quintic spline interpolant from monotone data was discussed in my previous paper <dt-cite key="lux2020quintic"></dt-cite>, but not how to make a <i>piecewise</i> monotone quintic spline interpolant over nonmonotone data. This report outlines the process of constructing a <i>piecewise</i> monotone quintic spline interpolant, which requires a few additional steps.</p>

<p>The only change required is in the estimation of initial derivative values of the function. Two different methods for approximating the first and second derivatives of the function \(f\) at points \(x_i\) are studied here. The first and second derivative estimates produced by these two methods are refined with the same "step towards monotonicity" procedure defined in my HPC SpringSim paper <dt-cite key="lux2020quintic"></dt-cite>. The same procedure for stepping towards monotonicity works on the entire quintic spline regardless of the direction of the function over individual intervals because the convergence towards monotonicity is guaranteed by shrinking first derivative values to zero, which is applicable regardless of the direction of monotonicity of intervals.</p>

<p>First and second derivative constraints for the approximation can be constructed based on the points and function values, namely:</p>

<p>
<ol><li> \(f(x_{j-1}) < f(x_j) < f(x_{j+1})\) implies \(Df(x_j) \geq 0,\)</li>
<li> \(f(x_{j-1}) > f(x_j) > f(x_{j+1})\) implies \(Df(x_j) \leq 0,\)</li>
<li> \(\big(f(x_j) - f(x_{j-1}) \big) \big(f(x_{j+1}) - f(x_j)\big) < 0\) implies \(Df(x_j) = 0\), and</li>
<li> \(f(x_j) = f(x_{j+1})\) implies \(0 = Df(x_j)\) \(= Df(x_{j+1})\) \(= DDf(x_j)\) \(= DDf(x_{j+1}).\)</li></ol></p>

<p>In the general case, the two derivative estimation methods considered in this report are:</p>

<table>
<tr><td> <b>METHOD</b> </td><td> </td><td> </td><td> <b>Description</b> </td></tr>

<tr><td> <b>1</b> </td><td> <i>Quintic</i><br><i>interpolant</i> \(\hat f_6\)  </td><td> \(\quad\) </td><td> For strictly monotone data this method interpolates at \(x_{j-2},\) \(x_{j-1},\) \(x_j,\) \(x_{j+1},\) \(x_{j+2},\) and the nearer to \(x_j\) of \(x_{j-3}\) and \(x_{j+3}.\) For nonmonotone data this method interpolates increasingly many nearby values and derivatives (derivatives constructed from 1--4) until a quintic is produced. This requires a lot of cases to clearly define, but generally picks nearer points and lower derivatives to build the quintic (or lower order when there are not enough values to make a quintic). </td></tr>

<tr><td> <b>2</b> </td><td> <i>Quadratic</i><br><i>regressor</i> \(\hat f_r\)  </td><td>         </td><td> Interpolates at \(x_j,\) performs weighted quadratic regression over all \(x_i\) for \(i \neq j,\) where weight of \(x_i\) is proportional to \(1 / |x_j - x_i|^2.\) When a first derivative is given at \(x_j\), that constraint is included in the fit. </td></tr></table>

<p>\( \)</p>

<p>What follows are examples of the resulting piecewise monotone quintic spline interpolants constructed after each method provides initial derivative estimates. The spline will be a solid blue line, the provided points are styled according to constraints (see legend below), and the shape of the local fit for each point is a dotted line interpolating that point (if you can't see it, it's because it overlaps the blue line). The first test problem considered is as follows.</p>

<p><p style='position: relative; height: 330px;'><iframe src='pmqsi_example.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p>For context, here is the PCHIP (Piecewise <b>Cubic</b> Hermite Interpolating Polynomial) interpolant produced over these points and values.</p>

<p><p style='position: relative; height: 330px;'><iframe src='pchip_example.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p>
<p style="page-break-after: always;"></p>

</p><span class='header' id='Method 1: Quintic interpolant'></span><h2> Method 1: Quintic interpolant</h2>

<p><p style='position: relative; height: 330px;'><iframe src='6_pmqsi_example.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>
<span class='header' id='Method 2: Quadratic regression'></span><h2> Method 2: Quadratic regression</h2>

<p><p style='position: relative; height: 330px;'><iframe src='r_pmqsi_example.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>
<span class='header' id='Extended Test Problems'></span><h2> Extended Test Problems</h2>

<p>In addition to that one problem, the following examples may also be of interest. The resulting piecewise monotone quintic spline interpolant from method one is a blue solid line, from method two is the dotted green line.</p>

<p><p style='position: relative; height: 420px;'><iframe src='test_0.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p>Test 0 above is a repeat visual of the same point set from before. It is only included to observe both methods on the same plot.</p>

<p><p style='position: relative; height: 420px;'><iframe src='test_1.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_2.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_3.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_4.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_5.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_6.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>

<p><p style='position: relative; height: 420px;'><iframe src='test_7.html' frameBorder='0' style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'></iframe></p></p>
<span class='header' id='Discussion of Results'></span><h2> Discussion of Results</h2>

<p>While the local quintic approximation (method 1) seems to work well for random data, it is unfortunately wiggly where true underlying functions transition between linear pieces. However, if the true underlying function is actually piecewise linear, then isn't it a bad idea to use a \(C^2\) approximation?</p>

<p>I'm very open to suggestions for better methods! Some ideas: minimize "oscillation" for quintic interpolant (minimize L2 of third derivative), or only use the nearest five points in the weighted quadratic regression.</p>


    </dt-article>

    
<dt-appendix>
</dt-appendix>


    <script type="text/bibliography">


@inproceedings{lux2020quintic,
 author = {Lux, Thomas C. H. and Watson, Layne T. and Chang, Tyler H. and Xu, Li and Wang, Yueyao and Hong, Yili},
 title = {An Algorithm for Constructing Monotone Quintic Interpolating Splines},
 year = {2020},
 publisher = {Society for Computer Simulation International},
 address = {San Diego, CA, USA},
 booktitle = {Proceedings of the High Performance Computing Symposium},
 articleno = {Article 42},
 numpages = {12},
 keywords = {monotone, quintic spline, Hermite interpolation, sixth order polynomial},
 series = {HPC ’20},
 url = {https://tchlux.github.io/papers/tchlux-2019-HPC-1.pdf},
}
</script>

    
<!--
     ============================================= 
          DISTILL PROPER USAGE AND FORMATTING      
     ============================================= 

        Article Foundation (can use h2 for description)    
    =======================================================
    <dt-article>
      <h1> [title text] </h1>
      <p> [description text] </p>
      <dt-byline></dt-byline>
      [article content]
    </dt-article>
    <dt-appendix>
    </dt-appendix>
    <script type="text/bibliography">
      @article{,
      title={},
      author={},
      journal={},
      year={},
      url={}
      }
      ...
    </script>

        Body and Headers    
    ========================
    <p></p>
    <h1></h1>
    <h2></h2>
    <h3></h3>
    <h4></h4>

        Citations    
    =================
    <dt-cite key="[key name]"></dt-cite>

        Code (use block for multiple lines)    
    ===========================================
    <dt-code block language="[language]">
      [code]
    </dt-code>

        Footnotes    
    =================
    <dt-fn> [text] </dt-fn>

        Lists (unordered uses <ul> instead)    
    ===========================================
    <p>
      <ol>
	<li> [entry text]
      </ol>
    </p>

        Math    
    ============
    \( [inline math text] \)
    $$ [newline math text]  $$

        Styling    
    ===============
    <i> [italics] </i> 
    <b> [bold] </b>
    <br> [line break]
    <font color="[color]"> [colored text] </font>

        Tables    
    ==============
    <table>
      <tr> [table row]
	<td> [table column] </td> ...
      </tr>
    </table>

         Custom Widths for Tables     
    ==================================
    <style type="text/css">
      td {
        width: 200px;
        padding: 0px 0px 0px 50px;
        background-color: #eee;
      }
    </style>


    =======================
        EXAMPLE ARTICLE
    =======================

    <!doctype html>
    <meta charset="utf-8">
    <script src="https://distill.pub/template.v1.js"></script>

    <script type="text/front-matter">
      title: "Article Title"
      description: "Description of the post"
      authors:
      - Chris Olah: http://colah.github.io
      - Shan Carter: http://shancarter.com
      affiliations:
      - Google Brain: http://g.co/brain
      - Google Brain: http://g.co/brain
    </script>

    <dt-article>
      <h1>Hello World</h1>
      <h2>A description of the article</h2>
      <dt-byline></dt-byline>
      <p>This is the first paragraph of the article.</p>
      <p>We can also cite <dt-cite key="gregor2015draw"></dt-cite> external publications.</p>
    </dt-article>

    <dt-appendix>
    </dt-appendix>

    <script type="text/bibliography">
      @article{gregor2015draw,
      title={DRAW: A recurrent neural network for image generation},
      author={Gregor, Karol and Danihelka, Ivo and Graves, Alex and Rezende, Danilo Jimenez and Wierstra, Daan},
      journal={arXivreprint arXiv:1502.04623},
      year={2015},
      url={https://arxiv.org/pdf/1502.04623.pdf}
      }
    </script>

-->


    
